<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
	<title>TABLA REGISTROS DE VISITANTES</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <link rel="stylesheet" href="/resources/css/tablas.css" type="text/css" media="all">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
  <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>

  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.html5.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.1.5/js/buttons.html5.styles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.1.5/js/buttons.html5.styles.templates.min.js"></script>
  <link type="image/x-icon"
    href="https://upload.wikimedia.org/wikipedia/commons/thumb/3/32/Escudo_de_Medell%C3%ADn_%28versi%C3%B3n_Alcald%C3%ADa%29.svg/1200px-Escudo_de_Medell%C3%ADn_%28versi%C3%B3n_Alcald%C3%ADa%29.svg.png"
    rel="icon" />

</head>
<body>
  <h2>TABLA <span class="text-muted">REGISTRO DE VISITANTES</span> </h2>
  <a href="/visitors" class="btn btn-outline-secondary">Regresar</a>

      <table id="example"  class=" table table-striped table-ligth table-hover ">
        <thead class="text-center">
        <tr>
          <th>N√πmero de Documento</th>
          <th>Tipo de Documento</th>
          <th>Nombre Completo</th>
          <th>Secretar√¨a</th>
          <th>Ocupaci√≤n</th>
          <th>Fecha de nacimiento</th>
          <th>Edad</th>
          <th>Enfoque Diferencial</th>
          <th>Comuna o Corregimiento</th>
          <th>Correo</th>
          <th>Organizaci√≤n</th>
          <th>Tel√®fono</th>
          <th>Sexo</th>
          <th>lugar</th>
          <th>Acciones</th>

        </tr>
        </thead>
        <tbody>
          
          <% for(let i = 0; i < registro.length; i ++ ) {%> 
            <tr>
              <td> <%=registro[i].numero_documento%> </td>
              <td> <%=registro[i].tipo_documento %> </td>
              <td> <%=registro[i].nombre_completo %> </td>
              <td> <%=registro[i].secretaria_entidad %> </td>
              <td> <%=registro[i].ocupacion %> </td>
              <td> <%=registro[i].fecha_nacimiento %> </td>
              <td> <%=registro[i].edad %> </td>
              <td> <%=registro[i].enfoque_diferencial %> </td>
              <td> <%=registro[i].degradacion_territorial %> </td>
              <td> <%=registro[i].correo_electronico%> </td>
              <td> <%=registro[i].organizacion%> </td>
              <td> <%=registro[i].telefono_celular%> </td>
              <td> <%=registro[i].sexo%> </td>
              <td> <%=registro[i].concatenar%> </td>
              <td>
                <button type="button" data-bs-toggle="modal" data-bs-target="#modalEliminar<%=registro[i].numero_documento%>" class="btn btn-outline-danger m-1" title="Eliminar Usuario" >‚ùå</button>

                <div class="modal fade" id="modalEliminar<%=registro[i].numero_documento%>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Eliminar Usuario</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <h3>Confirmar Eliminaci√≥n:</h3>
                        <div class="mb-3">
                        <label for="recipient-name" class="col-form-label">Nombre</label>
                        <input readonly value="<%= registro[i].nombre_completo%> ">
                        </div>
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Documento</label>
                          <input readonly value="<%= registro[i].numero_documento%> ">
                          </div>
                         </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <a  href="/delete.registro/<%=registro[i].numero_documento%>" class="btn btn-primary">Aceptar</a>
                      </div>
                    </div>
                  </div>
                </div>
            
              <button type="button" title="Editar" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exampleModal<%=registro[i].numero_documento %>" data-bs-whatever="@fat"> üñã</button></td>
            </tr>

            <div class="modal fade" id="exampleModal<%=registro[i].numero_documento%>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">MODIFICA EL CAMPO REQUERIDO</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <form method ="post" action="/edit.registro/<%= registro[i].numero_documento%>">
                      <div class="mb-3">
                        <label for="message-text" class="col-form-label">	Tipo de documento</label>
                        <select name ="tipo_documento" id="tipo" class="select"  value="<%=registro[i].tipo_documento %>">
                          <option value ="cedula de ciudadania" >C√©dula de Ciudadan√≠a (CC)</option>
                          <option value="cedula de extranjeria"  >C√©dula de extranger√≠a (CE)</option>
                          <option value ="tarjeta de identidad" >Tarjeta de Identidad (TI)</option>
                          <option value ="pasaporte" >Pasaporte</option>
                          <option value ="registro civil" >Registro Civil (RC)</option>
                          <option value ="numero unico de identificacion personal" >N√∫mero √önico de Identificaci√≥n Personal (NUIP)</option>
                          <option value ="numero de identificacion personal" >N√∫mero de Identificaci√≥n Personal (NIP)</option>
                        </select>
                        </div>
                        
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Nombre Completo</label>
                          <input type="text" class="form-control" id="recipient-name" name="nombre_completo" value="<%= registro[i].nombre_completo%>">
                        </div>
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Secretar√¨a o entidad</label>
                          <input type="text" class="form-control" id="recipient-name" name="secretaria_entidad" value="<%= registro[i].secretaria_entidad%>">
                        </div>
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Ocupaci√≤n</label>
                          <input type="text" class="form-control" id="recipient-name" name="ocupacion" value="<%= registro[i].ocupacion%>">
                        </div>
                        <div class="mb-3">
                          <label for="recipient-name" class="col-form-label">Fecha de Nacimiento</label>
                          <input type="text" class="form-control" id="recipient-name" name="fecha_nacimiento" value="<%= registro[i].fecha_nacimiento%>">
                        </div>
                        <div class="mb-3">
                          <label for="message-text" class="col-form-label">Enfoque diferencial</label>
                             <select name ="enfoque_diferencial" id="tipo" class="select" value="<%=registro[i].enfoque_diferencial %>" >
                               <option value ="<%= registro[i].enfoque_diferencial %>" selected disabled><%= registro[i].enfoque_diferencial %> </option>
                               <option value ="Afrodescendiente" >Afrodescendiente</option>
                               <option value="Indigena"  >Indigena</option>
                               <option value ="ROM" >ROM</option>
                               <option value ="LGBTIQ+" >LGBTIQ+</option>
                               <option value ="Situacion de calle" >Situacion de calle</option>
                               <option value ="Campesino" >Campesino</option>
                               <option value ="Discapacidad" >Discapacidad</option>
                               <option value ="Poblacion victima">Poblaci√≥n victima</option>
                             </select>
                        </div>
                        <div class="mb-3">
                          <label for="message-text" class="col-form-label">Comuna o Corregimiento</label>
                          <select name ="degradacion_territorial" id="tipo" class="select"  value="<%=registro[i].degradacion_territorial %>" >
                            <option value ="" selected disabled>Selecciona una comuna</option>
                            <option value ="1. Popular" >1. Popular</option>
                            <option value="2. Santa Cruz"  >2. Santa Cruz</option>
                            <option value ="3. Manrique" >3. Manrique</option>
                            <option value="4. Aranjuez"  >4. Aranjuez</option>
                            <option value ="5. Castilla" >5. Castilla</option>
                            <option value="6. 12 de Octubre"  >6. 12 de Octubre</option>
                            <option value ="7. Robledo" >7. Robledo</option>
                            <option value="8. Villa Hermosa"  >8. Villa Hermosa</option>
                            <option value ="9. Buenos Aires" >9. Buenos Aires</option>
                            <option value="10. La Candelaria"  >10. La Candelaria</option>
                            <option value ="11. Laureles Estadio" >11. Laureles Estadio</option>
                            <option value="12. La America"  >12. La America</option>
                            <option value ="13. San javier" >13. San javier</option>
                            <option value="14. El Poblado"  >14. El Poblado</option>
                            <option value ="15. Guayabal" >15. Guayabal</option>
                            <option value="16. Bel√©n"  >16. Bel√©n</option>
                            <option value ="50. San Sebastian de Palmitas" >50. San Sebastian de Palmitas</option>
                            <option value="60. San Cristobal"  >60. San Cristobal</option>
                            <option value ="70. Alta Vista" >70. Alta Vista</option>
                            <option value="80. San Antonio de Prado"  >80. San Antonio de Prado</option>
                            <option value ="90. Santa Elena" >90. Santa Elena</option>
                          </select>
                        </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">Correo</label>
                    <input class="form-control" id="message-text" type="email" name="correo_electronico" value="<%=registro[i].correo_electronico %>"></input>
                  </div>

                  <div class="mb-3">
                    <label form="tipo">Organizaci√≥n</label>
                      <select name ="organizacion" id="tipo" class="select" value="<%=registro[i].organizacion %>">
                        <option value ="" selected disabled>Selecciona el tipo de Organizaci√≥n</option>
                        <option value ="JAL" >JAL</option>
                        <option value="JAC"  >JAC</option>
                        <option value ="PP" >PP</option>
                        <option value ="PDL" >PDL</option>
                        <option value ="N/A" >N/A</option>
                      </select>
                  </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">t√®lefono</label>
                    <input class="form-control" type="text" id="message-text" name="telefono_celular" value="<%=registro[i].telefono_celular %>"></input>
                  </div>
                  <div class="mb-3">
                    <label for="message-text" class="col-form-label">Sexo</label>
                    <input class="form-control" type="text" id="message-text" name="sexo" value="<%=registro[i].sexo %>"></input>
                  </div>

                    <!-- <div class="mb-3">
                      <label for="recipient-name" class="col-form-label">Ocupaci√≤n</label>
                      <input type="text" class="form-control" id="recipient-name" name="IdCds" value="<%= registro[i].concatenar%>">
                    </div> -->

                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Cancelar</button>
                    <input type="submit" class="btn btn-primary" value ="Aceptar">
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
            <% } %>
        </tbody>
    </table> 
    <script>
      $(document).ready(function() {
         table = $('#example').DataTable({
        });
    
        //Creamos una fila en el head de la tabla y lo clonamos para cada columna
        $('#example thead tr').clone(true).appendTo( '#example thead' );
    
        $('#example thead tr:eq(1) th').each( function (i) {
            var title = $(this).text(); //es el nombre de la columna
            $(this).html( '<input type="text" placeholder="Search...'+title+'" />' );
     
            $( 'input', this ).on( 'keyup change', function () {
                if ( table.column(i).search() !== this.value ) {
                    table
                        .column(i)
                        .search( this.value )
                        .draw();
                }
            } );
       
        } );  
    
        table.destroy();
    
    $(document).ready(function() {
    $('#example').DataTable({

      orderCellsTop: true,
      destroy: true,
       fixedHeader: true,
            "language": {
              "url": "https://cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json",
              },
                "dom": 'Bfrtlip',
                  "buttons":{
                    "dom":{
                     "button":{
                       "className": 'btn'
                              }
                            },
                  "buttons":[{
                     "extend":"excel",
                       "text": '<i class="fas fa-file-excel"></i>',
                         "className": 'btn btn-outline-success mb-1',
                              "titleAttr": 'Exportar a Excel',
                              "excelStyles":{
                                "template": 'green_medium'
                              }
                            }] 
                        }                                      
          })         
        });
      }); 
 </script>
   <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
   <script src="/resources/js/validacion.js"></script>
  
 
   <% if(typeof alert !="undefined" ){%>
     <script>
       Swal.fire({
         title: '<%= title %>',
         icon: '<%= icon %>',
         showConfirmButton: '<%= showConfirmButton %>',
         timer: '<%= timer %>',
       }).then(() => {
           window.location = '/<%= ruta %>'
       })
     </script>
     <% } %>
</body>

</html>